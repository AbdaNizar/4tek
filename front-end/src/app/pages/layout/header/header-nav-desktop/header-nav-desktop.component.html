<nav class="mega" aria-label="Navigation catégories">
  <!-- TRIGGER -->
  <button
    class="trigger"
    type="button"
    (mouseenter)="openPanel(); cancelClose()"
    (mouseleave)="closeAfter(160)"
    (click)="toggle()"
    [attr.aria-expanded]="open()"
    aria-controls="mega-panel">
    <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
      <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
    </svg>
    <span>TOUS NOS CATÉGORIES</span>
  </button>

  <!-- PANEL -->
  <div
    id="mega-panel"
    class="panel"
    *ngIf="open()"
    [class.single]="activeCatId() && !hasSubs(activeCatId()!)"
    (mouseenter)="cancelClose()"
    (mouseleave)="closeAfter(160)">

    <ul class="cat-list" role="menu">
      <li *ngFor="let c of categories()"
          [class.active]="activeCatId()===c._id">
        <button class="row" type="button" role="menuitem"
                (mouseenter)="onEnterCat(c)" (focusin)="onEnterCat(c)"
                (click)="goCat(c)">
          <span class="left">
            <span class="ico"><img loading="lazy" [src]="catIcon(c)" [alt]="c.name"/></span>
            <span class="lbl">{{ c.name }}</span>
          </span>
          <span class="chev" *ngIf="hasSubs(c._id)">›</span>
        </button>
      </li>
    </ul>

    <div class="subcol" *ngIf="activeCatId() && hasSubs(activeCatId()!)">
      <h4 class="sub-title">{{ catName(activeCatId()!) }}</h4>
      <ul class="sub-list">
        <li *ngFor="let s of subsOf(activeCatId()!)">
          <a href (click)="goSub($event, s)">
            <span class="left">
              <span class="ico sm"><img loading="lazy" [src]="subIcon(s)" [alt]="s.name"/></span>
              <span class="lbl">{{ s.name }}</span>
            </span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>
